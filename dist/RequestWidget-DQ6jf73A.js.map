{"version":3,"file":"RequestWidget-DQ6jf73A.js","sources":["../src/pages/RequestWidget/RequestWidget.jsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { toast } from \"react-toastify\";\r\nimport axios from \"../../components/Hooks/axios\";\r\nimport Loading from \"../../components/Loading/Loading\";\r\nimport { timeAgo } from \"../../components/utils/HelperFunctions\";\r\nimport { setOpenLoadingPopup } from \"../../redux/slice/tempSlice\";\r\nimport styles from \"./RequestWidget.module.scss\";\r\n\r\nconst RequestWidget = () => {\r\n\tconst dispatch = useDispatch();\r\n\tconst { user } = useSelector((state) => state.user);\r\n\tconst [email, setEmail] = useState(user?.email);\r\n\tconst [widgetType, setWidgetType] = useState(\"\");\r\n\tconst [message, setMessage] = useState(\"\");\r\n\r\n\t// State to store submitted requests, initialized with initial requests\r\n\tconst [requests, setRequests] = useState([]);\r\n\r\n\t// State to track expanded requests\r\n\tconst [expandedRequests, setExpandedRequests] = useState(Object.fromEntries(requests.map((_, index) => [index, false])));\r\n\r\n\t// Handle form submission\r\n\tconst [uploading, setUploading] = useState(false);\r\n\tconst [reload, setReload] = useState(0);\r\n\tconst handleSubmit = (e) => {\r\n\t\te.preventDefault();\r\n\r\n\t\tsetUploading(true);\r\n\t\taxios\r\n\t\t\t.post(`/requestWidget`, { email, type: widgetType, details: message })\r\n\t\t\t.then(({ data }) => {\r\n\t\t\t\tsetEmail(\"\");\r\n\t\t\t\tsetWidgetType(\"\");\r\n\t\t\t\tsetMessage(\"\");\r\n\t\t\t\tsetReload(Math.random());\r\n\t\t\t})\r\n\t\t\t.catch((err) => {\r\n\t\t\t\ttoast.error(err?.response?.data?.message || \"Error making widget request...\");\r\n\t\t\t})\r\n\t\t\t.finally(() => setUploading(false));\r\n\t};\r\n\r\n\t// Toggle Read More / Read Less\r\n\tconst toggleReadMore = (index) => {\r\n\t\tsetExpandedRequests((prev) => ({\r\n\t\t\t...prev,\r\n\t\t\t[index]: !prev[index],\r\n\t\t}));\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tdispatch(setOpenLoadingPopup(true));\r\n\t\taxios\r\n\t\t\t.get(\"/requestWidgets\")\r\n\t\t\t.then(({ data }) => {\r\n\t\t\t\tsetRequests(data?.requests);\r\n\t\t\t})\r\n\t\t\t.catch((err) => {\r\n\t\t\t\ttoast.error(err?.response?.data?.message || err?.res?.data?.msg || \"Error fetching requests..\");\r\n\t\t\t})\r\n\t\t\t.finally(() => dispatch(setOpenLoadingPopup(false)));\r\n\t}, [reload]);\r\n\r\n\treturn (\r\n\t\t<div className={styles.RequestWidget}>\r\n\t\t\t{/* Form Section */}\r\n\t\t\t<div className={styles.FormContainer}>\r\n\t\t\t\t<h2>Request Widget</h2>\r\n\t\t\t\t<p>Lorem ipsum dolor sit amet consectetur. Tellus risus ut massa quis vitae viverra aet.</p>\r\n\t\t\t\t<form className={styles.Form} onSubmit={handleSubmit}>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"email\"\r\n\t\t\t\t\t\tplaceholder=\"Your Email\"\r\n\t\t\t\t\t\tvalue={email}\r\n\t\t\t\t\t\tonChange={(e) => setEmail(e.target.value)}\r\n\t\t\t\t\t\tclassName={styles.Input}\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\treadOnly\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tplaceholder=\"Type of Widget\"\r\n\t\t\t\t\t\tvalue={widgetType}\r\n\t\t\t\t\t\tonChange={(e) => setWidgetType(e.target.value)}\r\n\t\t\t\t\t\tclassName={styles.Input}\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<textarea\r\n\t\t\t\t\t\tplaceholder=\"Write Something\"\r\n\t\t\t\t\t\tvalue={message}\r\n\t\t\t\t\t\tonChange={(e) => setMessage(e.target.value)}\r\n\t\t\t\t\t\tclassName={styles.Textarea}\r\n\t\t\t\t\t\trequired></textarea>\r\n\r\n\t\t\t\t\t{uploading ? (\r\n\t\t\t\t\t\t<button className={styles.SubmitButton}>\r\n\t\t\t\t\t\t\t<Loading color=\"#fff\" />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<button type=\"submit\" className={styles.SubmitButton}>\r\n\t\t\t\t\t\t\tSubmit\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Submitted Requests Section */}\r\n\t\t\t<div className={styles.SubmittedRequestsContainer}>\r\n\t\t\t\t<h3>Submitted Requests</h3>\r\n\t\t\t\t<div className={styles.RequestList}>\r\n\t\t\t\t\t{requests.map((request, index) => (\r\n\t\t\t\t\t\t<div key={index} className={styles.RequestCard}>\r\n\t\t\t\t\t\t\t<div className={styles.Left}>\r\n\t\t\t\t\t\t\t\t<div className={styles.RequestHeader}>\r\n\t\t\t\t\t\t\t\t\t<h4>{request?.type}</h4>\r\n\t\t\t\t\t\t\t\t\t<span>{timeAgo(request?.createdAt)}</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t\t\t{expandedRequests[index] ? request.details : `${request.details.slice(0, 100)}`}\r\n\t\t\t\t\t\t\t\t\t{/* Conditionally show \"Read More\" if message is longer than 100 characters */}\r\n\t\t\t\t\t\t\t\t\t{request.details.length > 100 && (\r\n\t\t\t\t\t\t\t\t\t\t<span className={styles.ReadMore} onClick={() => toggleReadMore(index)}>\r\n\t\t\t\t\t\t\t\t\t\t\t{expandedRequests[index] ? \" Show Less\" : \" ...Read More\"}\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className={styles.Status}>\r\n\t\t\t\t\t\t\t\t<span className={styles.StatusIndicator}></span>\r\n\t\t\t\t\t\t\t\t{request.status}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default RequestWidget;\r\n"],"names":["RequestWidget","dispatch","useDispatch","user","useSelector","state","_useState","useState","email","_useState2","_slicedToArray","setEmail","_useState3","_useState4","widgetType","setWidgetType","_useState5","_useState6","message","setMessage","_useState7","_useState8","requests","setRequests","_useState9","Object","fromEntries","map","_","index","_useState10","expandedRequests","setExpandedRequests","_useState11","_useState12","uploading","setUploading","_useState13","_useState14","reload","setReload","useEffect","setOpenLoadingPopup","axios","get","then","_ref2","data","err","_err$response2","_err$res","toast","error","response","undefined","res","msg","React","createElement","className","styles","onSubmit","e","preventDefault","post","type","details","_ref","Math","random","_err$response","placeholder","value","onChange","target","required","readOnly","Loading","color","request","key","timeAgo","createdAt","concat","slice","length","onClick","prev","_objectSpread","_defineProperty","toggleReadMore","status"],"mappings":"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"}