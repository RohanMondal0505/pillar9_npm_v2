import{_ as e,d as n,g as a,I as t,k as o,s as i,B as r,a as l,D as d,o as s,b as m,c}from"./index-DyP4ojMg.js";import*as u from"react";import{useState as _,useEffect as D}from"react";import{B as b,R as h,a as g,G as y}from"./index-B4sptC2-.js";import{useDispatch as p,useSelector as f}from"react-redux";import{useNavigate as v}from"react-router-dom";import{toast as x}from"react-toastify";import{C as E,P as C}from"./PlusButton-C6vAdZ0N.js";import{s as k}from"./AddWidgetPopup.module-B00OsTgg.js";import"localstorage-slim";import"axios";import"react-dom";var W=function(i){var r=i.setOpenEditPopup,l=p(),d=f((function(e){return e.dashboard})).openedDashboard,s=_((null==d?void 0:d.title)||""),m=e(s,2),c=m[0],D=m[1],b=_((null==d?void 0:d.widgets)||[]),h=e(b,2),g=h[0],y=h[1],v=_(["ListAgent","Dimensions","Segments","Time","Filter"]),W=e(v,2),N=W[0];W[1];return u.createElement("div",{className:k.AddWidgetPopup,onClick:function(){return r(!1)}},u.createElement("div",{className:k.Wrapper,onClick:function(e){return e.stopPropagation()}},u.createElement("div",{className:k.Top},u.createElement("div",{className:k.Left},u.createElement("h2",null,"Edit Dashboard"),u.createElement("div",{className:k.InputWrapper},u.createElement("label",{htmlFor:""},"title : "),u.createElement("input",{type:"text",value:c,onChange:function(e){return D(e.target.value)},placeholder:"Enter Dashboard Title"}))),u.createElement("div",{className:k.Right},u.createElement("button",{onClick:function(){return r(!1)}},"Discard"),u.createElement("button",{onClick:function(){if(c.trim()){var e=g.map((function(e,n){return{i:"box".concat(n+1),x:n%2*6,y:8*Math.floor(n/2),w:6,h:8}})),n={title:c,widgets:g,layout:e};l(a(!0)),t.put("/dashboard/update/".concat(null==d?void 0:d._id),n).then((function(e){var n=e.data;r(!1),l(o(null==n?void 0:n.data)),x.success((null==n?void 0:n.message)||"Dashboard Updated Successfully...")})).catch((function(e){var n;x.error((null==e||null===(n=e.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.message)||"Error Updating Dashboard.")})).finally((function(){return l(a(!1))}))}else x.error("Please provide a title for the dashboard.")}},"Save"))),u.createElement("div",{className:k.WidgetButtons},N.map((function(e,a){return u.createElement("div",{key:a,className:k.WidgetBtn},u.createElement("p",null,e),g.some((function(n){return n.name===e}))?u.createElement("span",{className:k.CrossButton,onClick:function(){return n=e,void y((function(e){return e.filter((function(e){return e.name!==n}))}));var n}},u.createElement("img",{src:E,alt:"Remove",title:"Remove"})):u.createElement("span",{className:k.Show,onClick:function(){return a=e,void y((function(e){return[].concat(n(e),[{name:a,isLocked:!1,isCollapsed:!1}])}));var a}},u.createElement("img",{src:C,alt:"Add",title:"Add"})))}))),u.createElement("div",{className:k.AllWidgets},g.map((function(e,n){return u.createElement("div",{key:n,className:k.WidgetBox},e.name," Widget")})))))},N={DynamicDashboard:"DynamicDashboard-module_DynamicDashboard__u4OxU",Top:"DynamicDashboard-module_Top__RWxN-",Buttons:"DynamicDashboard-module_Buttons__oovft",Widgets:"DynamicDashboard-module_Widgets__-WCzS",gridItem:"DynamicDashboard-module_gridItem__8Q1-x",ActionButtons:"DynamicDashboard-module_ActionButtons__ekNNE",Right:"DynamicDashboard-module_Right__xzk-o",Menu:"DynamicDashboard-module_Menu__inPFV",CustomMenu:"DynamicDashboard-module_CustomMenu__Km2AK",Content:"DynamicDashboard-module_Content__8xSng",Collapse:"DynamicDashboard-module_Collapse__77aS8"};i(".DynamicDashboard-module_DynamicDashboard__u4OxU {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n.DynamicDashboard-module_DynamicDashboard__u4OxU .DynamicDashboard-module_Top__RWxN- {\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n.DynamicDashboard-module_DynamicDashboard__u4OxU .DynamicDashboard-module_Top__RWxN- .DynamicDashboard-module_Buttons__oovft {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n.DynamicDashboard-module_DynamicDashboard__u4OxU .DynamicDashboard-module_Top__RWxN- .DynamicDashboard-module_Buttons__oovft button {\n  border-radius: 0.5rem;\n  background: var(--Ellipse-30, #e6d366);\n  display: inline-flex;\n  height: 3.5rem;\n  padding: 0.75rem 2.625rem;\n  justify-content: center;\n  align-items: center;\n  gap: 0.625rem;\n  flex-shrink: 0;\n  color: #fff;\n  font-family: Poppins;\n  font-size: 1rem;\n  font-style: normal;\n  font-weight: 500;\n  line-height: 1.25rem; /* 125% */\n  cursor: pointer;\n  border: none;\n  transition: all ease-in-out 0.3s;\n}\n.DynamicDashboard-module_DynamicDashboard__u4OxU .DynamicDashboard-module_Top__RWxN- .DynamicDashboard-module_Buttons__oovft button:hover {\n  opacity: 0.75;\n}\n\n.DynamicDashboard-module_Widgets__-WCzS {\n  display: flex;\n  flex-direction: column;\n  gap: 2rem;\n}\n.DynamicDashboard-module_Widgets__-WCzS .DynamicDashboard-module_gridItem__8Q1-x {\n  background-color: rgba(160, 201, 201, 0.068);\n  display: flex;\n  flex-direction: column;\n}\n@media print {\n  .DynamicDashboard-module_Widgets__-WCzS .DynamicDashboard-module_gridItem__8Q1-x {\n    display: none;\n  }\n}\n.DynamicDashboard-module_Widgets__-WCzS .DynamicDashboard-module_gridItem__8Q1-x .DynamicDashboard-module_ActionButtons__ekNNE {\n  padding: 0.7rem;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-bottom: 1px solid rgba(49, 51, 51, 0.151);\n}\n.DynamicDashboard-module_Widgets__-WCzS .DynamicDashboard-module_gridItem__8Q1-x .DynamicDashboard-module_ActionButtons__ekNNE .DynamicDashboard-module_Right__xzk-o {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n@media print {\n  .DynamicDashboard-module_Widgets__-WCzS .DynamicDashboard-module_gridItem__8Q1-x .DynamicDashboard-module_ActionButtons__ekNNE .DynamicDashboard-module_Right__xzk-o {\n    display: none;\n  }\n}\n.DynamicDashboard-module_Widgets__-WCzS .DynamicDashboard-module_gridItem__8Q1-x .DynamicDashboard-module_ActionButtons__ekNNE .DynamicDashboard-module_Right__xzk-o span {\n  cursor: pointer;\n}\n.DynamicDashboard-module_Widgets__-WCzS .DynamicDashboard-module_gridItem__8Q1-x .DynamicDashboard-module_ActionButtons__ekNNE .DynamicDashboard-module_Right__xzk-o .DynamicDashboard-module_Menu__inPFV {\n  position: relative;\n  display: inline-block;\n  cursor: pointer;\n}\n.DynamicDashboard-module_Widgets__-WCzS .DynamicDashboard-module_gridItem__8Q1-x .DynamicDashboard-module_ActionButtons__ekNNE .DynamicDashboard-module_Right__xzk-o .DynamicDashboard-module_CustomMenu__Km2AK {\n  position: absolute;\n  top: 100%;\n  right: 0;\n  list-style: none;\n  margin: 0;\n  padding: 0;\n  background: white;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);\n  z-index: 100;\n  min-width: 120px; /* Adjust the width as needed */\n}\n.DynamicDashboard-module_Widgets__-WCzS .DynamicDashboard-module_gridItem__8Q1-x .DynamicDashboard-module_ActionButtons__ekNNE .DynamicDashboard-module_Right__xzk-o .DynamicDashboard-module_CustomMenu__Km2AK li {\n  padding: 0.6rem 0.8rem;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem; /* Space between icon and text */\n  opacity: 1 !important;\n}\n.DynamicDashboard-module_Widgets__-WCzS .DynamicDashboard-module_gridItem__8Q1-x .DynamicDashboard-module_ActionButtons__ekNNE .DynamicDashboard-module_Right__xzk-o .DynamicDashboard-module_CustomMenu__Km2AK li:hover {\n  background: #f5f5f5;\n}\n.DynamicDashboard-module_Widgets__-WCzS .DynamicDashboard-module_gridItem__8Q1-x .DynamicDashboard-module_ActionButtons__ekNNE .DynamicDashboard-module_Right__xzk-o .DynamicDashboard-module_CustomMenu__Km2AK li svg {\n  font-size: 1rem;\n}\n.DynamicDashboard-module_Widgets__-WCzS .DynamicDashboard-module_gridItem__8Q1-x .DynamicDashboard-module_Content__8xSng {\n  flex: 1;\n  background-color: rgba(43, 40, 40, 0.048);\n  transition: all ease-in-out 0.3s;\n  transform-origin: top;\n  display: flex;\n  overflow: hidden;\n}\n.DynamicDashboard-module_Widgets__-WCzS .DynamicDashboard-module_gridItem__8Q1-x .DynamicDashboard-module_Content__8xSng img {\n  width: 100%;\n  height: 100%;\n}\n.DynamicDashboard-module_Widgets__-WCzS .DynamicDashboard-module_gridItem__8Q1-x .DynamicDashboard-module_Content__8xSng.DynamicDashboard-module_Collapse__77aS8 {\n  transform: scaleY(0);\n}");var z=function(n){var a=n.item,t=n.index,o=n.onWidgetStateChange,i=_(a.isCollapsed),m=e(i,2),c=m[0],D=m[1],y=_(a.isLocked),f=e(y,2),v=f[0],x=f[1],E=p(),C=_(!1),k=e(C,2),W=k[0],z=k[1],w=function(e){z(!1),x(e),o(t,"isLocked",e)},S=function(){D((function(e){return!e})),o(t,"isCollapsed",!c)};return u.createElement(u.Fragment,null,u.createElement("div",{className:N.ActionButtons,onClick:function(){return z(!1)}},u.createElement("div",{className:N.Left},null==a?void 0:a.name),u.createElement("div",{className:N.Right},v&&u.createElement("span",null,u.createElement(b,null)),!v&&(c?u.createElement("span",{onClick:S},"UnCollapse"):u.createElement("span",{onClick:S},"Collapse")),u.createElement("span",{onClick:function(){E(s(a))}},"View Full Screen"),!v&&u.createElement("span",{className:"".concat(N.dragHandleButton," dragHandle"),style:{cursor:"move"}},u.createElement(h,null)),u.createElement("span",{className:N.Menu},u.createElement(r,{onClick:function(e){return function(e){e.stopPropagation(),z(!W)}(e)}}),W&&u.createElement("ul",{className:N.CustomMenu},v?u.createElement("li",{onClick:function(){w(!1),z(!1)}},u.createElement(g,null),"Unlock"):u.createElement("li",{onClick:function(){w(!0),z(!1)}},u.createElement(l,null),"Lock"))))),u.createElement("div",{className:"".concat(N.Content," ").concat(c?N.Collapse:""),onClick:function(){return z(!1)}},"ListAgent"===(null==a?void 0:a.name)?u.createElement(d,null):u.createElement("p",{style:{margin:"auto"}},(null==a?void 0:a.name)+" widget")))},w=function(){var n,a=p(),i=f((function(e){return e.dashboard})).openedDashboard,r=_(!1),l=e(r,2),d=l[0],s=l[1],b=_(!1),h=e(b,2),g=h[0],E=h[1],C=v(),k=_(i),w=e(k,2),S=w[0],R=w[1],B=_(.8*window.innerWidth),A=e(B,2),I=A[0],Q=A[1];D((function(){var e=function(){Q(.8*window.innerWidth)};return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]);var L=[{i:"box1",x:0,y:0,w:12,h:8,isDraggable:!0,isResizable:!0},{i:"box2",x:0,y:8,w:6,h:8,isDraggable:!0,isResizable:!0},{i:"box3",x:6,y:8,w:6,h:8,isDraggable:!0,isResizable:!0},{i:"box4",x:0,y:16,w:8,h:8,isDraggable:!0,isResizable:!0},{i:"box5",x:8,y:16,w:4,h:8,isDraggable:!0,isResizable:!0}],M=_((function(){var e=null==i?void 0:i.layout;return e||L})),U=e(M,2),P=U[0],T=U[1],K=function(e,n,a){R((function(t){var o=t.widgets.map((function(t,o){return o===e?m(m({},t),{},c({},n,a)):m({},t)})),i=P.map((function(t,o){return o===e&&"isLocked"===n?m(m({},t),{},{isDraggable:!a,isResizable:!a}):o===e&&"isCollapsed"===n?m(m({},t),{},{isResizable:!a,h:a?1:8}):t}));return T(i),m(m({},t),{},{widgets:o})}))},j=_(!1),F=e(j,2),O=F[0],H=F[1];return D((function(){R(i),T(null==i?void 0:i.layout),E(!1)}),[i]),u.createElement(u.Fragment,null,d&&u.createElement(W,{setOpenEditPopup:s}),u.createElement("div",{className:N.DynamicDashboard},u.createElement("div",{className:N.Top},u.createElement("h1",null,"Title : ",null==S?void 0:S.title),u.createElement("div",{className:N.Buttons},u.createElement("button",{onClick:function(){C("/user/multi-dashboard"),a(o({}))}},"Back"),u.createElement("button",{onClick:function(){return s(!0)}},"Manage Widgets"),g&&u.createElement(u.Fragment,null,O?u.createElement("button",null,"Updating ...."):u.createElement("button",{onClick:function(){H(!0),t.put("/dashboard/update/".concat(null==S?void 0:S._id),{title:null==S?void 0:S.title,widgets:null==S?void 0:S.widgets,layout:null==S?void 0:S.layout}).then((function(e){var n=e.data;x.success((null==n?void 0:n.message)||"Dashboard Updated Successfully..."),a(o(null==n?void 0:n.data)),E(!1)})).catch((function(e){var n;x.error((null==e||null===(n=e.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.message)||"Error Updating Dashboard layout..")})).finally((function(){return H(!1)}))}},"Save Layout")))),u.createElement("div",{className:N.Widgets},u.createElement(y,{className:"layout",layout:P,cols:12,rowHeight:40,width:I,draggableHandle:".dragHandle",onLayoutChange:function(e){T(e),R((function(n){return m(m({},n),{},{layout:e})})),E(!0)}},null==S||null===(n=S.widgets)||void 0===n?void 0:n.map((function(e,n){var a,t,o,i,r,l;return u.createElement("div",{key:"box".concat(n+1),className:N.gridItem,"data-grid":m(m({},P[n]),{},{isDraggable:null===(a=null===(t=P[n])||void 0===t?void 0:t.isDraggable)||void 0===a||a,isResizable:null===(o=null===(i=P[n])||void 0===i?void 0:i.isResizable)||void 0===o||o,static:!(null!==(r=P[n])&&void 0!==r&&r.isDraggable||null!==(l=P[n])&&void 0!==l&&l.isResizable)})},u.createElement(z,{item:e,index:n,onWidgetStateChange:K}))}))))))};export{w as default};
//# sourceMappingURL=DynamicDashboard-DxR9AdsX.js.map
